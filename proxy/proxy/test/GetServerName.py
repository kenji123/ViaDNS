from dpkt.ssl import TLSRecord, TLSHandshake, TLSClientHello
from dpkt.ethernet import Ethernet
from dpkt.ip import IP
from dpkt.tcp import TCP
import binascii

_hexdecode = binascii.a2b_hex

data = _hexdecode('00226b7dbc9e0019e3d8fcf10800450000e02f4d40004006cb7bc0a8017b170d661fd14701bbcd2ab19b610b1f738018ffff85ef00000101080a2d8873b20d061ba916030100a7010000a303015046e4bc998e8a24c475184017d839d2b98bb85a865226c34149cbfc73626ef900004800ffc00ac0140088008700390038c00fc00500840035c007c009c011c0130045004400330032c00cc00ec002c0040096004100050004002fc008c01200160013c00dc003feff000a0100003200000014001200000f7365637572652e68756c752e636f6d000a00080006001700180019000b000201000023000033740000')
eth = Ethernet(data)
ip = IP(str(eth.data))
tcp = TCP(str(ip.data))
tr = TLSRecord(str(tcp.data))
th = TLSHandshake(str(tr.data))
tch = TLSClientHello(str(th.data))
print tch.extensions

data = _hexdecode('010000a303015046e4bc998e8a24c475184017d839d2b98bb85a865226c34149cbfc73626ef900004800ffc00ac0140088008700390038c00fc00500840035c007c009c011c0130045004400330032c00cc00ec002c0040096004100050004002fc008c01200160013c00dc003feff000a0100003200000014001200000f7365637572652e68756c752e636f6d000a00080006001700180019000b000201000023000033740000')
th = TLSHandshake(data)
tch = TLSClientHello(str(th.data))
print tch.extensions

data = _hexdecode('010000ab03015046d702688a086cf695dfe73f93123846df8a19ca59489164495a7e67e58f51000048c00ac0140088008700390038c00fc00500840035c007c009c011c01300450044006600330032c00cc00ec002c0040096004100050004002fc008c01200160013c00dc003feff000a0100003a0000001700150000127369676e75702e6e6574666c69782e636f6dff01000100000a00080006001700180019000b000201000023000033740000')
th = TLSHandshake(data)
tch = TLSClientHello(str(th.data))
print tch.extensions
